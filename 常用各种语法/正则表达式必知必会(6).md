# 正则表达式(6)

# 一. 修饰符

很多地方把修饰符，称作模式，听着顺口但表述并不准确。修饰符用于影响表达式的匹配逻辑， 比如`i`修饰符表示正则勿略大小写，而`g`要求正则匹配全部结果，默认情况下的正则只会匹配第一个结果。下表中列出了各语言中常见的修饰符。

修饰符列表：

| 修饰符                         | 描述                                                         | 兼容性           |
| :----------------------------- | :----------------------------------------------------------- | :--------------- |
| `g`lobal 全局匹配              | 默认只返回匹配到的第一个结果，加上`g`匹配全部可匹配结果      |                  |
| `i`nsensitive 勿略大小写       | 不区分大小写                                                 |                  |
| `m`ulti line 行边界修饰符      | 此模式下^和$可以分别匹配行首和行尾，默认情况下只能匹配文本开头与结尾 |                  |
| `s`ingle line **.** 通配修饰符 | 此模式下`.`能匹配任意字符，包括换行符                        |                  |
| e`x`tended 注释修饰符          | 忽略空白字符，可以多行书写，并使用#进行注释说明              | javascript不支持 |

## 1.1 g全局匹配

默认情况正则引擎匹配到第一个结果之后就结束了，加上`g`之后就会匹配全部可匹配结果。

## 1.2 i忽略大小写

这是最好理解的一个修饰符，解释它太费字了。接下来小试一把：

匹配文中所有span标签：

```
/<span>.*?<\/span>/gi
```

```html
<span>文本1</span>
<span>文本2</Span>
<span>文本3</span>
```

## 1.3 m行边界修饰符

很多地方把它叫 **多行模式**，让我误以为它的作用就是让正则把字符串按行拆分，然后在一行一行的匹配，事实上它的作用是于定义`^`与`$`边界断言的作用范围。默认情况下`^$`分别表示文本的开头与结尾，加上之后表示**行首**与**行尾**，也包括文本开头与结尾。一般的正则表达式应用都会加上`m`修饰符。

匹配文中所有正确的手机号码：

```
/^\d{11}$/gm
```

```
13577897654
1357789765413
13a534e42
11577837654
```

> 上例中没有加`m`情况下,`^$`表示文本的头尾，所以匹配不到手机号，加上后`^$`表示行首与行尾，所以能正确匹配。

## 1.4 s点通配符

`s`并不是所谓的**单行模式**，而是用来定义`.`是否包括换行？默认情况下不包括换行，加上之就包括换行符。工作中不建议使用该修饰符，会让结果变得不可预期。可以用`[\D\d]` 来代替`.`通配符。

匹配所有的div内容：

```
/<div>.*?<\/div>/gs
```

默认情况下`.`不包括换行，所以只能匹配第一对div,`s`加上后`.`包括了换行所以全部都能匹配。

> `m`与`s`并不是所谓的多行与单行模式，所以它们完全同时存在。

## 1.5 x注释修饰符

正则让人头痛一点就是字符太难以阅读，`x`注释修饰符可以一定程度上降低复杂性，该修饰符下正则的空行将被勿略，并且可以通过添加`#` 表示注释。如下面这个示例就是启用了`x`

```
<span>  #标签开头
.*?      #最少化匹配中间任意内容
<\/span> #标签结尾
```

由于`x`会勿略所有空白字符，所有类似 空格 tab制表符换行都需要使用`\s`代替。

注释还有另一种写法`(?#注释内容)` 它不需`x`修饰符的支持，不过这种写法在javascrip 与java中**不支持**。

> `x`在javascript中也不支持，所以javascript就直接不支持任何正则注释

## 1.6 工具中默认修饰符

在使用类似idea，vs code，或notepad++等工具时，其正则都添加了`gmi`三个修饰符，而且除了`i`大小写勿略，其它都不可以改变。

# 二. 常见案例

## 2.1 匹配注释

匹配出所有注释：

```
/\/\/.*?$|\/\*.*?\*\//gms
```

提醒项：把`gms`修饰符用上,正则会精简许多。

```
<script>
  /*注释块1*/ console.log(""); /*注释块2*/
  // 单行注释
  /*
   多行注释
   */
</script>
```













