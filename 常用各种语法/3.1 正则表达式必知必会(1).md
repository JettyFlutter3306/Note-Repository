# 正则表达式(1)

# 一. 组成正则的字符

## 1.1 确定字符

一个最简单的正则表达式，就是一组确定字符，如`hello`就是一个正则表达式，它会匹配下文中的hello。

```
hello曾小红 ,welcome to regex learn site
```

`hello` 是一组确定字符表达式，它严格按照顺序匹配文中`h` `e` `l` `l` `o`。然后相关工具会返回匹配的位置，一个简单正则交互就完成了。

## 1.2 不确定字符

正则使用场景中，搜索的字符大多是**不完全确定**的。如下文中的例子：

```
【阿里云】您正在登录验证，验证码2571，
切勿将验证码泄露于他人，本条验证码有效期15分钟。
```

短信中的验证码是不确定的，只知道一个范围--是4位**数字**。这时就可以通过元字符`\d`去匹配，它表示一个0-9中**一个**数字。因为验证码是4个数字，所以匹配正则应是`\d\d\d\d` .

## 1.3 混合字符

更多正则匹配场景中，是**确定**与**不确定**的字符混合在一起。如要匹配下文中年龄就得这么写`\d\d岁`：

```
曾小红，男，举重运动员，28岁，体重56KG，身高175cm。最好成绩：挺举98KG
```

如果要匹配体重得这么写`体重\d\dKG`，*体重*与*KG*是确定的，中间`\d\d`是不确定的。

匹配运动员的挺举成绩：`挺举\d\dKG`

组成正则表达式的字符，有些是确定的，有些是不确定的，正则编写时要尽可能缩小不确定字符的范围。关于`\d`这类表**范围**字符，正则表达式中还有好几个，对于写好正则，非常重要。

# 二. 范围字符

对于确定字符可以直接匹配，对于不确定的可以用**范围字符**来代替。下表是常用范围字符：

| 字符          | 描述                                                        | 兼容性                             |
| :------------ | :---------------------------------------------------------- | :--------------------------------- |
| `.`任意字符   | 除**换行符**外的任意单个字符                                | 添加`s`修饰符，可以让`.`包括换行符 |
| `\w` 单词字符 | 字母、数字、下划线任意单个字符。大写`\W` 表示**非单词**字符 | 在python `\w`还可以表示汉字        |
| `\d` 数字     | 0-9任意单个数字。大写`\D` 表示**非数字**                    |                                    |
| `\s` 空白字符 | 空格、tab制表符、换行都属于空白字符。大写`\S` 非空白字符    |                                    |

## 2.1 `.`任意字符

`.` 可以任意单个字符，字母、数字、汉字、标点符号，甚至是**.**自已。

匹配所有姓**张**的名字：

```
张..
```

## 2.2 `\w`单词字符

`\w` 表示字母、数字、下划线中任意**单个**字符。

匹配css样式中所有**颜色**代码：

```
#\w{6};
```

## 2.3 `\d`数字符

`\d` 表示0-9任意**单个**字符。

匹配文中所有的**生日**：

```
\d\d\d\d-\d\d-\d\d
```

大写的`\D`表示反义，即`\d`之外的字符。

## 2.4 `\s` 空白字符

`\s`表示**单个**空白字符，其包括空格、tab制表符、换行。注意：退格不属于空白字符。

大写的`\S`表示反义，即非空白字符，也是正则中常用字符。

# 三. 自定义范围字符

定义范围指由多个字符，多个范围字符组成的集合，取其中**任意**一个。

| 字符                  | 描述                                                         | 兼容性 |
| :-------------------- | :----------------------------------------------------------- | :----- |
| `[abc123]` 任意范围   | 一组由确定字符组成的字符集，取其中**一个**                   |        |
| `[0-9]` 数字区间范围  | 指定数字范围集，`[0-9]` 等同于`\d`                           |        |
| `[a-z]` 字母区间范围  | 指定字母范围集。                                             |        |
| `[\d\w\s]` 固定范围集 | 由多个固定范围集，组成一个更大的集                           |        |
| `[0-9A-F\s]` 混合集   | 上述四个自定义混合组成的集                                   |        |
| `[^ ]` 排除范围       | 表示`[ ]`集之外的任单个字符，如`[^0-9]` 表示非数字，效果等同于`\D` |        |

## 3.1 `[abc123]` 任意范围

`[ ]` 由指定字符组成的范围集，可匹配其中任意一个。`[abc123%#]`表示匹配abc123%#其中之一。

匹配姓：**张、沈、薛**的名字：

```
[张沈薛]..
```

## 3.2 `[0-9]` 区间范围

`[1-5]` 表示 1、2、3、4、5 中任意一个字符。

`[n-m]`匹配下文中合法的日期：

```
\d\d\d\d-[01]\d-[0-3]\d
```

## 3.3 `[a-z0-9]` 混合范围集

`[a-c\d]` 表示 a、b、c字母或0-9数字中任意一个字符。等同于 `[a-c0-9]`。

匹配合法的**颜色**代码：

```
#[a-f\d]{6};
```

以#开头的6位十六进制数用于表示颜色，规律如下 ：

- 以`#`开头,以`;`结尾
- 由6个字母或数字组成
- 16进制字母只能是a-f
- 匹配结果包括`#`和`;`

## 3.4 `[^ ]` 排除范围集

`[^ ]` 排除范围集中的字符，该集可以指定任意字母、数字、或其它固定集。举例`[^\D8-9]` 表示排除所有非数字，以及8和9。等同于`[0-7]`

匹配80年代或90年代**以外**的日期：

```
\d\d[^8-9\D]\d-\d\d-\d\d
```

提示： 通过`[^8-9]` 排除年份中的第**3**位。

## 3.5 `[.$^]`范围集中的特殊字符

`.`表示任意字符，但在`[.]` 中它表示的是 **.** 字符本身。甚至是`^`、`-`、`[`、`]` 范围集本身语法，如果不是在恰当位置，也表示其字符本身。为避免混淆建议大家在范围集中匹配特殊字符时，统一加上 **转义符** `\`。 如 `[\^\.]` 表示匹配 **^** 或 **.**

## 3.6 `\`转义特殊字符

如果要匹配`[`、`*`等特殊字符，需要加入一个转义符:`\`即可。转义符也可加在范围字符中如`[\-]` 表示一个普通的 **-** 。

# 四. 常见案例

## 4.1 匹配车牌号码

匹配文中正确的车牌号码：

普通车牌特征：

1. 第1位是表籍贯的汉字
2. 第2位是表城市的大写字母，**不包括**I和O。因为容易和数字0和1混淆
3. 后5位是字母加数字，也**不包括**I和O

提示：如何表示除IO之外的字母呢？

```
[湘皖鲁][A-HJ-NP-Z][A-HJ-NP-Z\d]{5}
```

测试文本：

```
湘C4VQR6
湘G9NRCE
湘A3EWAY
湘D4U9U5
湘C6FBKN
湘A0Z5VK
湘D2HQUS
皖DOCLYJ
皖E74V7I
皖E9T3RK
皖11WEIZ
鲁C67RSN
鲁C8WU2C
鲁E2S1EF
A湘418KB
鲁P9RNA7
鲁B1ETSP
鲁C195ES
N鲁5FSTV
鲁Z140YQ
```